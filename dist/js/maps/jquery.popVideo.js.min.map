{"version":3,"sources":["jquery.popVideo.js"],"names":["$","PopVideo","element","options","this","$body","document","body","$element","popid","$wrapper","video","$video","self","isOpen","init","isPlay","paused","isLoop","attr","VERSION","DEFAULTS","playOnOpen","closeOnEnd","pauseOnClose","loop","closeKey","title","duration","callback","onOpen","onClose","onPlay","onPause","onEnd","prototype","getDefaults","getOptions","extend","data","Error","Math","random","getElementById","tpl","append","find","setVideo","on","close","open","css","fadeIn","e","preventBubble","play","window","one","keyCode","pause","fadeOut","off","destroy","remove","old","fn","popVideo","option","$this","Constructor","noConflict","jQuery"],"mappings":"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","file":"../jquery.popVideo.js","sourcesContent":["+function ($) {\r\n    'use strict';\r\n\r\n    // PopVideo CLASS DEFINITION\r\n    // ======================\r\n    var PopVideo = function (element, options) {\r\n        this.options = options\r\n        this.$body = $(document.body)\r\n        this.$element = $(element)\r\n        this.popid = null\r\n        this.$wrapper = null\r\n        this.video = null\r\n        this.$video = null\r\n        var self = this\r\n        this.isOpen = false\r\n        this.init(element, options)\r\n        this.isPlay = function () {\r\n            return !self.$video[0].paused\r\n        }\r\n        this.isLoop = function () {\r\n            return !!self.$video.attr('loop')\r\n        }\r\n    }\r\n    PopVideo.VERSION = \"0.0.3\";\r\n    PopVideo.DEFAULTS = {\r\n        playOnOpen: false,\r\n        closeOnEnd: false,\r\n        pauseOnClose: true,\r\n        loop: false,\r\n        closeKey: 'esc', //(String || Boolean) 可选值 any，false,esc。其他值默认为esc\r\n        title: '',\r\n        video: '',//(String || Array)\r\n        duration: 300,\r\n        callback: {\r\n            // TODO 回调的插入位置\r\n            onOpen: function () {\r\n                //窗口打开时\r\n            },\r\n            onClose: function () {\r\n                //窗口关闭时\r\n            },\r\n            onPlay: function () {\r\n                //视频播放时\r\n            },\r\n            onPause: function () {\r\n                //视频暂停\r\n            },\r\n            onEnd: function () {\r\n                //视频播放完毕\r\n            }\r\n        }\r\n    }\r\n    PopVideo.prototype.getDefaults = function () {\r\n        return PopVideo.DEFAULTS\r\n    }\r\n    PopVideo.prototype.getOptions = function (options) {\r\n        options = $.extend({}, this.getDefaults(), this.$element.data(), options)\r\n        return options\r\n    }\r\n    PopVideo.prototype.init = function (element, options) {\r\n        this.options = this.getOptions(options);\r\n        var video = !!this.options.video ? this.options.video : this.$element.attr('src');\r\n        if (!video) {\r\n            throw new Error('`video` option must be specified when initializing or the element must have the src attribute ')\r\n        } else {\r\n            this.video = video;\r\n        }\r\n        var loop = this.options.loop ? 'loop': '';\r\n        //生成一个随机5位数，作为id\r\n        var popid = 'popid-'\r\n        do popid += ~~(Math.random() * 100000)\r\n        while (document.getElementById(popid))\r\n        this.popid = popid\r\n        //TODO 自定义控制界面\r\n        var tpl = '<div class=\"popvideo-wrapper\" id=\"' + popid + '\">' +\r\n            '<div class=\"popvideo\">' +\r\n            '<div class=\"popvideo-head\">' +\r\n            '<a href=\"javascript:void(0)\" class=\"popvideo-close\">&times;</a><h3 class=\"popvideo-title\">' + this.options.title + '</h3>' +\r\n            '</div>' +\r\n            '<div class=\"popvideo-content\">' + '<video controls '+loop+'></video>' +\r\n            '</div></div></div>';\r\n        $('body').append(tpl);\r\n        this.$wrapper = $('#' + popid);\r\n        this.$video = this.$wrapper.find('video');\r\n        this.setVideo(video);\r\n        // 为x添加close事件\r\n        var self = this;\r\n        this.$wrapper.find('.popvideo-close').on('click.popvideo.close',function () {\r\n            self.close();\r\n        });\r\n        if(this.options.closeOnEnd){\r\n            self.$video.on('ended.close', function () {\r\n                self.close();\r\n            });\r\n        }\r\n    };\r\n    PopVideo.prototype.open = function () {\r\n        $('body').css('overflow', 'hidden');\r\n        this.$wrapper.fadeIn(this.options.duration).on('scroll.popvideo', function (e) {\r\n            e.preventBubble();\r\n        });\r\n        if (this.options.playOnOpen) {\r\n            this.play();\r\n        }\r\n        var self = this;\r\n        if(this.options.closeKey){\r\n            var key = this.options.closeKey;\r\n            switch (key){\r\n                case 'any':\r\n                    $(window).one('keyup.closeKey', function (e) {\r\n                        if (e.keyCode) {\r\n                            self.close();\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'esc':\r\n                    $(window).one('keyup.closeKey', function (e) {\r\n                        if (e.keyCode === 27) {\r\n                            self.close();\r\n                        }\r\n                    });\r\n                    break;\r\n                default:\r\n                    $(window).one('keyup.closeKey', function (e) {\r\n                        if (e.keyCode === 27) {\r\n                            self.close();\r\n                        }\r\n                    });\r\n                    break;\r\n            }\r\n        }\r\n        this.isOpen = true;\r\n        //打开后回调onOpen函数\r\n        this.options.callback.onOpen();\r\n    };\r\n    PopVideo.prototype.play = function () {\r\n        this.$video[0].play();\r\n    }\r\n    PopVideo.prototype.pause = function () {\r\n        this.$video[0].pause();\r\n    }\r\n    PopVideo.prototype.close = function () {\r\n        $('body').css('overflow', 'auto');\r\n        this.$wrapper.fadeOut(this.options.duration).off('scroll.popvideo');\r\n        if (this.options.pauseOnClose) {\r\n            this.pause();\r\n        }\r\n        this.isOpen = false;\r\n    };\r\n    PopVideo.prototype.destroy = function () {\r\n        this.$body.remove(this.$wrapper);\r\n    };\r\n    PopVideo.prototype.setVideo = function (video) {\r\nthis.$video.attr('src',video);\r\n    }\r\n\r\n    // PopVideo PLUGIN DEFINITION\r\n    // ===========================\r\n\r\n    function Plugin(option) {\r\n        // return this.each(function () {\r\n        //     var $this = $(this)\r\n        //     var data = $this.data('PopVideo')\r\n        //     if (!data) $this.data('PopVideo', (data = new PopVideo(this, option)))\r\n        //     if (typeof option == 'string') data[option]()\r\n        // })\r\n        var $this = $(this)\r\n        var data = $this.data('PopVideo')\r\n        if (!data) $this.data('PopVideo', (data = new PopVideo(this, option)))\r\n        if (typeof option === 'string') data[option]()\r\n        return data;\r\n    }\r\n\r\n    var old = $.fn.popVideo\r\n\r\n    $.fn.popVideo = Plugin\r\n    $.fn.popVideo.Constructor = PopVideo\r\n\r\n\r\n    // PopVideo NO CONFLICT\r\n    // =====================\r\n\r\n    $.fn.popVideo.noConflict = function () {\r\n        $.fn.popVideo = old\r\n        return this\r\n    }\r\n\r\n}(jQuery);"]}